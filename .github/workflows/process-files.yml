name: Process Files

on:
  push:
    branches:
      - main

jobs:
  lint:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Set up Node.js for Super Linter
        uses: actions/setup-node@v3
        with:
          node-version: '14'

      - name: Install Super Linter
        run: |
          npm install -g eslint
          npx super-linter --install

      - name: Run Super Linter
        uses: github/super-linter@v5
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          linters: all
          # Customize the configuration as needed
          # e.g., config-file: .super-linter.yml

  process:
    runs-on: ubuntu-latest
    needs: lint

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Set up JQ and Utilities
        run: sudo apt-get install -y jq tar gzip

      - name: Run Shell Script
        run: |
          chmod +x process_tar_files.sh
          ./process_tar_files.sh

      - name: List Generated Files
        run: |
          echo "Listing all files after script execution:"
          ls -l *.tar.gz

      - name: Upload Processed Files
        uses: actions/upload-artifact@v3
        with:
          name: processed-tar-files
          path: "*.tar.gz"